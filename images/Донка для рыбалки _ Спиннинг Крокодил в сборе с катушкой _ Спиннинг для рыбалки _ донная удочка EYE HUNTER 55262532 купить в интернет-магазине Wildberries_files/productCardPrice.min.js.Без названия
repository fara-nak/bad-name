(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach(function(t){_defineProperty(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var e=function(){function e(e,t,i,r){var n,o,s;this.parentId=e,this.nmId=t.nmId,this.enabledForRegion=t.enabledForRegion,this.allSizesSoldOut=t.allSizesSoldOut,this.sizeSoldOut=null!==(n=null===(o=t.selectedSize)||void 0===o?void 0:o.isSoldOut)&&void 0!==n&&n,this.selectedPrice=t.selectedPrice,this.pickupAvailable=null===(s=t.selectedSize)||void 0===s?void 0:s.pickupAvailable,this.isDigital=i.isDigital,this.statsModel=r,this._currentNomeclature=t,this._product=i,this.priceSummary.depends=["nmId","selectedPrice","pickupAvailable"],this.onSizeUpdated=this.onSizeUpdated.bind(this),this.onColorChaged=this.onColorChaged.bind(this),this.onProductChaged=this.onProductChaged.bind(this)}var t=e.prototype;return t.priceSummary=function(){var e,t,i=this.selectedPrice;if(!i)return{};var r=i.price-i.salePrice,n=this._currentNomeclature.addToBookingEnable,o=!(this._product.isDigital||n||this._product.isVideo||this._product.isActivationKey)&&wb.global.settings.variables.minCreditSum>=0&&wb.global.settings.variables.minCreditSum<i.salePrice?Math.floor(i.salePrice/10):0;return _objectSpread({wbaStatHandlers:{cardCommonShowEventsWba:this.statsModel.cardCommonShowEventsWba,cardCommonActionEventsWba:this.statsModel.cardCommonActionEventsWba},pickupAvailable:this.pickupAvailable,paymentInUsd:!(null===(e=wb.global.settings)||void 0===e||null===(t=e.variables)||void 0===t||!t.toUsdExchangeRate),onlyCash:n,finalSaving:r,creditPayment:o},i)},t.init=function(){return this._bindEvents(),this},t.destroy=function(){return this._unbindEvents(),this},t.onSizeUpdated=function(e){var t,i,r=e.detail,n=r.nmId,o=r.selectedSize;if(this.nmId==n&&o!=(null===(t=this.selectedSize)||void 0===t?void 0:t.characteristicId)){var s=this._currentNomeclature.sizes.find(function(e){return e.characteristicId===o});null!=s&&s.isSoldOut?$.observable(this).setProperty({selectedPrice:null}):null!=s&&s.price?$.observable(this).setProperty({selectedPrice:s.price}):$.observable(this).setProperty({selectedPrice:null===(i=this._product.nomenclatures.find(function(e){return e.nmId===n}))||void 0===i?void 0:i.price}),$.observable(this).setProperty({sizeSoldOut:s.isSoldOut,pickupAvailable:s.pickupAvailable})}},t.onColorChaged=function(e){var t,i,r,n=e.detail,o=n.sourceId,s=n.sourceNmId,d=n.selectedNomenclature;o==this.parentId&&s==this.nmId&&($.observable(this).setProperty({nmId:d.nmId,enabledForRegion:d.enabledForRegion,allSizesSoldOut:d.allSizesSoldOut,sizeSoldOut:null!==(t=null===(i=d.selectedSize)||void 0===i?void 0:i.isSoldOut)&&void 0!==t&&t,selectedPrice:d.selectedPrice,pickupAvailable:null===(r=d.selectedSize)||void 0===r?void 0:r.pickupAvailable}),this._currentNomeclature=d)},t.onProductChaged=function(e){var t,i,r,n,o=e.detail,s=o.sourceId,d=o.sourceNmId,l=o.selectedNomenclature,a=o.product;s==this.parentId&&d==this.nmId&&($.observable(this).setProperty({nmId:l.nmId,enabledForRegion:l.enabledForRegion,isDigital:a.isDigital,minOrderSum:null!==(t=a.minOrderSum)&&void 0!==t?t:0,allSizesSoldOut:l.allSizesSoldOut,sizeSoldOut:null!==(i=null===(r=l.selectedSize)||void 0===r?void 0:r.isSoldOut)&&void 0!==i&&i,selectedPrice:l.selectedPrice,pickupAvailable:null===(n=l.selectedSize)||void 0===n?void 0:n.pickupAvailable}),this._currentNomeclature=l,this._product=a)},t._bindEvents=function(){this.$eventBus.addEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.addEventListener("ProductColorChanged",this.onColorChaged),this.$eventBus.addEventListener("ProductChanged",this.onProductChaged)},t._unbindEvents=function(){this.$eventBus.removeEventListener("ProductSizeUpdated",this.onSizeUpdated),this.$eventBus.removeEventListener("ProductColorChanged",this.onColorChaged),this.$eventBus.removeEventListener("ProductChanged",this.onProductChaged)},_createClass(e,[{key:"template",get:function(){return e.template}}]),e}();window.__spaModuleManager__.register("productCardPrice",e)}();

},{}]},{},[1]);
